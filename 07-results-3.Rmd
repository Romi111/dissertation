# Results for Research Question #3: How do data practices relate to youth engagement in the programs?

```{r, setup-3, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, 
                      message = FALSE, 
                      warning = FALSE, 
                      collapse = TRUE,
                      error = TRUE,
                      fig.width = 6,
                      fig.asp = .618,
                      out.width = "80%", 
                      fig.align = "center", 
                      results = "hold",
                      knitr.kable.na = '') 

options(knitr.kable.NA = '')
```

```{r}
df <- read_csv("data/for-seven-profiles.csv")
cc <- df %>% select(dm_cog_eng:dm_competence) %>% complete.cases()
C <- select(m1_6, C)

C_p_m <- select(m1_6, CPROB1:CPROB6) %>%
  apply(MARGIN = 1, FUN = max)

C_p <- select(m1_6, CPROB1:CPROB6)

df_ss <- df[cc, ]

df_ss <- bind_cols(df_ss, C_p)
df_ss$profile <- C
df_ss$profile_p <- C_p_m

d <- df_ss %>% select(contains("dm"), participant_ID, program_ID, beep_ID = beep_ID_new, profile, profile_p, overall_pre_interest, youth_activity_rc, inquiry_based, inquiry_based_three, classroom_versus_field_enrichment, gender_female, urm, contains("cprob"), dm_composite_di)

d <- d %>%
  mutate(
    profile_1 = ifelse(profile == 1, 1, 0),
    profile_2 = ifelse(profile == 2, 1, 0),
    profile_3 = ifelse(profile == 3, 1, 0),
    profile_4 = ifelse(profile == 4, 1, 0),
    profile_5 = ifelse(profile == 5, 1, 0),
    profile_6 = ifelse(profile == 6, 1, 0),
    profile_1_p = CPROB1,
    profile_2_p = CPROB2,
    profile_3_p = CPROB3,
    profile_4_p = CPROB4,
    profile_5_p = CPROB5,
    profile_6_p = CPROB6
  )
```

```{r, rq2-0-null, cache = FALSE, eval = TRUE}
m1 <- lmer(profile_1_p ~ 1 +
             (1 | participant_ID) +
             (1 | beep_ID) +
             (1 | program_ID),
           data = d)

m2 <- lmer(profile_2_p ~ 1 +
             (1 | participant_ID) +
             (1 | beep_ID) +
             (1 | program_ID),
           data = d)

m3 <- lmer(profile_3_p ~ 1 +
             (1 | participant_ID) +
             (1 | beep_ID) +
             (1 | program_ID),
           data = d)

m4 <- lmer(profile_4_p ~ 1 +
             (1 | participant_ID) +
             (1 | beep_ID) +
             (1 | program_ID),
           data = d)

m5 <- lmer(profile_5_p ~ 1 +
             (1 | participant_ID) +
             (1 | beep_ID) +
             (1 | program_ID),
           data = d)

m6 <- lmer(profile_6_p ~ 1 +
             (1 | participant_ID) +
             (1 | beep_ID) +
             (1 | program_ID),
           data = d)
```

```{r, rq2-1-all-vars-com-keep, cache = FALSE}
m1a <- lmer(profile_1_p ~ 1 +
              # gender_female +
              # urm +
              dm_ask + dm_obs + dm_gen + dm_mod + dm_com +
              (1 | participant_ID) +
              (1 | beep_ID) +
              (1 | program_ID),
            data = d)

m2a <- lmer(profile_2_p ~ 1 +
              # gender_female +
              # urm +
              dm_ask + dm_obs + dm_gen + dm_mod + dm_com +
              (1 | participant_ID) +
              (1 | beep_ID) +
              (1 | program_ID),
            data = d)

m3a <- lmer(profile_3_p ~ 1 +
              # gender_female +
              # urm +
              dm_ask + dm_obs + dm_gen + dm_mod + dm_com +
              (1 | participant_ID) +
              (1 | beep_ID) +
              (1 | program_ID),
            data = d)

m4a <- lmer(profile_4_p ~ 1 +
              # gender_female +
              # urm +
              dm_ask + dm_obs + dm_gen + dm_mod + dm_com +
              (1 | participant_ID) +
              (1 | beep_ID) +
              (1 | program_ID),
            data = d)

m5a <- lmer(profile_5_p ~ 1 +
              # gender_female +
              # urm +
              dm_ask + dm_obs + dm_gen + dm_mod + dm_com +
              (1 | participant_ID) +
              (1 | beep_ID) +
              (1 | program_ID),
            data = d)

m6a <- lmer(profile_6_p ~ 1 +
              # gender_female +
              # urm +
              dm_ask + dm_obs + dm_gen + dm_mod + dm_com +
              (1 | participant_ID) +
              (1 | beep_ID) +
              (1 | program_ID),
            data = d)
```

```{r, rq2-2-composite-keep, cache = FALSE}
m1b <- lmer(profile_1_p ~ 1 +
              dm_composite +
              # gender_female +
              # urm +
              (1 | participant_ID) +
              (1 | beep_ID) +
              (1 | program_ID),
            data = d)

m2b <- lmer(profile_2_p ~ 1 +
              dm_composite +
              # gender_female +
              # urm +
              (1 | participant_ID) +
              (1 | beep_ID) +
              (1 | program_ID),
            data = d)

m3b <- lmer(profile_3_p ~ 1 +
              dm_composite +
              # gender_female +
              # urm +
              (1 | participant_ID) +
              (1 | beep_ID) +
              (1 | program_ID),
            data = d)

m4b <- lmer(profile_4_p ~ 1 +
              dm_composite +
              # gender_female +
              # urm +
              (1 | participant_ID) +
              (1 | beep_ID) +
              (1 | program_ID),
            data = d)

m5b <- lmer(profile_5_p ~ 1 +
              dm_composite +
              # gender_female +
              # urm +
              (1 | participant_ID) +
              (1 | beep_ID) +
              (1 | program_ID),
            data = d)

m6b <- lmer(profile_6_p ~ 1 +
              dm_composite +
              # gender_female +
              # urm +
              (1 | participant_ID) +
              (1 | beep_ID) +
              (1 | program_ID),
            data = d)
```

```{r, rq2-2-composite-keep-2, cache = FALSE}
m1bi <- lmer(profile_1_p ~ 1 +
              dm_composite_di +
              (1 | participant_ID) +
              (1 | beep_ID) +
              (1 | program_ID),
            data = d)

m2bi <- lmer(profile_2_p ~ 1 +
              dm_composite_di +
              # gender_female +
              # urm +
              (1 | participant_ID) +
              (1 | beep_ID) +
              (1 | program_ID),
            data = d)

m3bi <- lmer(profile_3_p ~ 1 +
              dm_composite_di +
              # gender_female +
              # urm +
              (1 | participant_ID) +
              (1 | beep_ID) +
              (1 | program_ID),
            data = d)

m4bi <- lmer(profile_4_p ~ 1 +
              dm_composite_di +
              # gender_female +
              # urm +
              (1 | participant_ID) +
              (1 | beep_ID) +
              (1 | program_ID),
            data = d)

m5bi <- lmer(profile_5_p ~ 1 +
              dm_composite_di +
              # gender_female +
              # urm +
              (1 | participant_ID) +
              (1 | beep_ID) +
              (1 | program_ID),
            data = d)

m6bi <- lmer(profile_6_p ~ 1 +
              dm_composite_di +
              # gender_female +
              # urm +
              (1 | participant_ID) +
              (1 | beep_ID) +
              (1 | program_ID),
            data = d)
```

### Null models

The null models presented in the table provide insight into the levels at which predictors may be able to explain the outcome. For all six profiles, the ICCs were very small, from 0.00 to 0.023. This suggests that very little variability can be explained simply by the program. For the momentary level, the ICCs were also very small, ranging from 0.004 to 0.011. Finally, the youth-level ICCs ranged from .099 to .427. Looking across these values, considering variability at the program, momentary, and youth levels, most of the explained variability in the responses is associated with youth; the program and momentary levels were associated with very small values, suggesting that variables at these levels have minimal variability to explain. In turn, this suggests that these variables, including those for work with data, may not have strong effects in terms of their relations with the PECs.

In terms of specific ICCs at the youth level, the value for the youth-level ICC was highest for the *full* profile, suggesting that some youth have a strong tendency to be fully engaged (possibly due to their initial interest or other individual characteristics and differences). The other profile characterized by a consistent pattern across all of the variables--the *universally low* profile--had a modest ICC, .265. Finally, a large amount of variability is associated with the residual (variance that is not associated with the program, momentary, or youth levels). This suggests that there is wide variation in students' responses that may not be readily explained or predicted.

### Models with variables for aspects of work with data added separately

When the predictor variables for work with data are added, some overall patterns and specific findings can be identified. The only relations with *p*-values that were below the criterion for statistical significance (.05) were for the relations between modeling data and the *full* profile (*B* = 0.036 (0.016), *p* = .016) and between generating data and the full profile (*B* = 0.029 (0.015), *p* = .024).

Adding these variables changed the (conditional upon the random effects) r-squared values from, .002 to .018, very small changes suggesting that the aspects of work with data do not strongly predict the PECs. This is in-line with the correlations for these variables with those variables that make up the profiles, and the ICC values at the momentary level.

```{r-r2-1, eval = FALSE}
MuMIn::r.squaredGLMM(m1) # .108
MuMIn::r.squaredGLMM(m2) # .295
MuMIn::r.squaredGLMM(m3) # .324
MuMIn::r.squaredGLMM(m4) # .109
MuMIn::r.squaredGLMM(m5) # .268
MuMIn::r.squaredGLMM(m6) # .482

MuMIn::r.squaredGLMM(m1a) # .115
MuMIn::r.squaredGLMM(m2a) # .300
MuMIn::r.squaredGLMM(m3a) # .321
MuMIn::r.squaredGLMM(m4a) # .101
MuMIn::r.squaredGLMM(m5a) # .270
MuMIn::r.squaredGLMM(m6a) # .50
```

The sensitivity analysis for the effect of generating data suggested that 1.884% of the inference would have to be due to bias to invalidate the inference, suggesting that this effect is not very robust to potential sources of bias, such as an omitted (in this analysis) confounding (or control) variable. For the effect of modeling, 9.835% would need to be due to bias to invalidate the inference. This effect, then, is less sensitive to possible sources of bias, but is still not highly robust.

```{r, rq2-1-tab, eval = FALSE}
l <- list(m1a, m2a, m3a, m4a, m5a, m6a)
o <- map_df(l, tidy_model)
write_rds(o, "data/rq2-1-tab.rds")
```

```{r, rq2-1-tab-pres}
o <- read_rds("data/rq2-1-tab.rds")

o <- mutate(o, model = c(
  str_c("profile_", 1:6)))

o %>%
  select(model,
         intercept = `(Intercept)`,
         dm_ask, dm_obs, dm_gen, dm_mod, dm_com,
         beep_ID_ICC = beep_ID_ICC,
         participant_ID_ICC,
         program_ID_ICC) %>%
  mutate(model = c("Only behavioral",
                   "Universally low",
                   "Engaged and competent but not challenged",
                   "Only affective",
                   "All moderate",
                   "Full")) %>%
  knitr::kable(format = "latex", booktabs = TRUE, caption = "Results of mixed effects models for work with data as separate variables", linesep = "") %>%
  kableExtra::kable_styling(latex_options = "scale_down") %>%
  kableExtra::landscape()
```

```{r, sensitivity-analysis-for-rq1, eval = FALSE, cache = FALSE}
konfound::konfound(m6a, dm_gen)
konfound::konfound(m6a, dm_mod)
konfound::konfound(m6a, gender_female) # need to add
```

### Models with the composite added

For the composite of work with data, the composite predicted the profile for *only behavioral* (*B* = 0.007 (0.004), *p* = .021), but not any of the other profiles. However, this coefficient is very small in practical terms, and 12.261% would need to be due to bias to invalidate the inference. The change in r-squared values ranged from .003 to .020, suggesting minimal potential relations among factors (such as support for work with data as measured by the composite variable) at the momentary level. When the composite was treated as a dichotomous (instead of a continuous) variable, so that the variable takes a value of one if any of the aspects of work with data are present, the results are similar in terms of the magnitude of the effects and their significance, as none of the relations are statistically significant when the dichotomous variable is used.

```{r, sens-2, eval = FALSE, cache = FALSE}
konfound(m1b, dm_composite)
```

```{r-r2-2, eval = FALSE}
MuMIn::r.squaredGLMM(m1) # .108
MuMIn::r.squaredGLMM(m2) # .295
MuMIn::r.squaredGLMM(m3) # .324
MuMIn::r.squaredGLMM(m4) # .109
MuMIn::r.squaredGLMM(m5) # .268
MuMIn::r.squaredGLMM(m6) # .482

MuMIn::r.squaredGLMM(m1b) # .113
MuMIn::r.squaredGLMM(m2b) # .298
MuMIn::r.squaredGLMM(m3b) # .320
MuMIn::r.squaredGLMM(m4b) # .100
MuMIn::r.squaredGLMM(m5b) # .269
MuMIn::r.squaredGLMM(m6b) # .502
```

```{r, just-composite-mod, eval = FALSE}
l <- list(m1b, m2b, m3b, m4b, m5b, m6b)
o <- map_df(l, tidy_model)
write_rds(o, "data/comp-l.rds")
```

```{r, just-composite-red}
o <- read_rds("data/comp-l.rds")
o <- mutate(o, model = c(
  str_c("profile_", 1:6)))

o %>%
  select(model,
         intercept = `(Intercept)`,
         dm_composite,
         beep_ID_ICC = beep_ID_ICC,
         participant_ID_ICC,
         program_ID_ICC) %>%
  mutate(model = c("Only behavioral",
                   "Universally low",
                   "Engaged and competent but not challenged",
                   "Only affective",
                   "All moderate",
                   "Full")) %>%
  knitr::kable(format = "latex", booktabs = TRUE, caption = "Results of mixed effects models for the composite", linesep = "") %>%
  kableExtra::kable_styling(latex_options = "scale_down") %>%
  kableExtra::landscape()
```

```{r, just-composite-mod-2, eval = FALSE}
l <- list(m1bi, m2bi, m3bi, m4bi, m5bi, m6bi)
o <- map_df(l, tidy_model)
write_rds(o, "data/comp-l-2.rds")
```

```{r, just-composite-red-2, eval = FALSE}
o <- read_rds("data/comp-l-2.rds")
o <- mutate(o, model = c(
  str_c("profile_", 1:6)))

o %>%
  select(model,
         intercept = `(Intercept)`,
         dm_composite_di,
         beep_ID_ICC = beep_ID_ICC,
         participant_ID_ICC,
         program_ID_ICC) %>%
  mutate(model = c("Only behavioral",
                   "Universally low",
                   "Engaged and competent but not challenged",
                   "Only affective",
                   "All moderate",
                   "Full")) %>%
  knitr::kable(format = "latex", booktabs = TRUE, caption = "Results of mixed effects models for the composite", linesep = "") %>%
  kableExtra::kable_styling(latex_options = "scale_down") %>%
  kableExtra::landscape()
```

### Summary of findings for research question #2

When looking across findings, we find few relations between work with data and the profiles, though there were notable effects of modeling and generating data, though they were small effects (i.e., when students are doing this, they are around 3% more likely to be responding in a way associated with the *full* profile). 

```{r}
data_frame(profile = c("Only behavioral",
                   "Universally low",
                   "Engaged and competent but not challenged",
                   "Only affective",
                   "All moderate",
                   "Full"),
           asking_questions = c(NA, NA, NA, NA, NA, NA),
           observing = c(NA, NA, NA, NA, NA, NA),
           generating = c(NA, NA, NA, NA, NA, "+"), 
           modeling = c(NA, NA, NA, NA, NA, "+"), 
           communicating = c("+", NA, NA, NA, NA, NA),
           composite = c("+", NA, NA, NA, NA, NA)) %>% 
    knitr::kable(format = "latex", booktabs = TRUE, caption = "Summary of results for research question #3", linesep = "") %>%
  kableExtra::kable_styling(latex_options = "scale_down") %>%
  kableExtra::landscape()
```

The composite for work with data had a relation of around 0.01 with the *only behavioral* profile, suggesting that for each one-value increase in the composite (which has a range from one to five), this profile is around 1% more likely. These findings are similar to those obtained when the model 1 type, seven profile solution is used for the outcome variables; see the appendix for more detail. Broadly, further explanations and investigations of these effects --focusing on the characteristics of work with data in the context of summer STEM programs and how this support is measured in terms of codes from the video--are the focus on research question #4 and are discussed in the next chapter. Moreover, these findings are deepened in subsequent analyses for research questions #3.
